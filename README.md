# 🟣 乃木坂46 MSG 備份工具 GUI (非官方)

一個基於 [colmsg](https://github.com/proshunsuke/colmsg) 的圖形化介面工具，專為乃木坂46 Message App 設計。提供備份和**離線網頁瀏覽**。
## ✨ 主要功能 
### 📥 備份與下載管理
*   **直覺式 GUI 介面**：免去輸入繁雜指令，直接透過視窗操作 `colmsg`。
*   **多執行緒處理**：備份過程不會卡死介面，並提供即時的執行日誌 (Log) 視窗。
*   **彈性成員選擇**：支援備份「全部訂閱成員」、「指定成員」（以逗號 `,` 分隔多位成員，如：`久保史緒里,田村真佑`）。
### 📱 HTML 離線瀏覽器
可生成一個類似 App 體驗的 `index.html` 單一入口網頁：

*   **單一入口**：所有成員整合在同一個 `index.html`，左側欄位可快速切換成員，無需在資料夾間翻找。
*   **暱稱替換**：輸入自己的`暱稱`，自動將訊息中的 `%%%` 替換為自己的暱稱，還原「專屬對話」感。
*   **對話體驗**：支援文字、圖片、影片、語音訊息的完整顯示。
*   **導航功能**：頂部下拉選單可快速跳轉至特定年月份。
### 🎨 客製化與互動
*   **自訂成員頭像**：
    *   內建頭像設定工具，可為每位成員選擇電腦中的圖片。
    *   自動將圖片整理至 `avatars/` 資料夾，保持根目錄整潔。
*   **側邊欄拖曳排序**：
    *   **自訂順序**：可直接用滑鼠拖曳左側成員名字調整順序（例如將首推移至最上方）。
    *   **自動記憶**：瀏覽器會自動記住排好的順序，下次開啟依然保留。
*   **圖片瀏覽體驗**：
    *   **燈箱效果**：點擊圖片可直接在當前頁面放大檢視，背景變暗。
    *   **防誤觸**：點擊圖片本身不關閉，點擊周圍空白處才關閉。
    *   **尺寸控制**：提供 25% (預設) / 50% / 75% / 100% 的圖片縮放選項，影片固定為 65% 寬度。
### 🛠️ 使用者體驗優化
*   **閱讀位置記憶**：
    *   自動記錄最後瀏覽的成員。
    *   自動記錄每位成員的「捲動位置」，切換回來時會停在上次看到的地方。
*   **快速導航**：右下角懸浮按鈕可快速回到頂部/底部。  
---
## 💡 如何使用
### 1. 前置準備
本工具依賴 **colmsg** 核心程式，請先前往 [colmsg 官方 GitHub](https://github.com/proshunsuke/colmsg) 下載執行檔。
### 2. 檔案放置
請確保您的資料夾結構如下：(將本工具與 `colmsg.exe` 放在同一資料夾)
```text
NogiBackup/
├── colmsg.exe       <-- 核心程式 (必須存在)
├── NogkSaver.exe    <-- 本工具 
└── nogizaka/        <-- (備份後會自動產生此資料夾)
```
### 3. 操作步驟
1.  開啟 `NogkSaver.exe`
2.  **Refresh Token：** 填入您抓包取得的 Refresh Token（需自行取得）
3.  **儲存位置：** 選擇備份檔案存放的路徑。
4.  點擊 **「開始備份」**
5.  備份完成後，在下方輸入暱稱並勾選 **「□ 自訂頭像」** (選填)
6.  點擊 **「產生入口網頁」** 即可生成離線瀏覽器
---
## 🐛已知問題
   * **感謝訂閱訊息：** 因為 API 資料特性，訂閱時的第一則「感謝訂閱」訊息` 可能 `不會顯示在第一則。
---
## 關於本專案 & 討論
# 🤖 AI 生成聲明
本專案的程式碼架構與邏輯完全由 AI 協助生成。<br>
程式碼可能不夠精簡或完美，非常歡迎大家自由修改、優化程式碼、或是 Fork 出去二次開發，希望能讓這個工具更好用！
# 📄免責聲明
 * 本工具僅為 colmsg 的圖形化介面 ，不包含任何破解或繞過機制。
 * 請勿將本工具用於非法用途或散布付費內容。
 * 使用本工具產生的任何風險由使用者自行承擔。
# 💬 交流與回饋
如果你有任何使用上的問題、想要許願新功能，或是想聊聊關於備份的心得：

回報 Bug：請使用 [Issues]( https://github.com/ann-nogk/Nogi-MSG-GUI/issues) 頁面。<br>
閒聊與討論：歡迎至 [Discussions]( https://github.com/ann-nogk/Nogi-MSG-GUI/discussions) 區留言。
